# DP(Disease Prediction)

## 1. 프로젝트 개요

-   **개발 기간**: 2025.03 ~ 2025.06
-   **기술 스택**: React, FastAPI, MySQL, Docker, EC2
-   **프로젝트 유형**: 2인 프로젝트
-   **맡은 역할**:
    -   서버 설계
    -   모델 개발
    -   백엔드

> **GitHub Repository URL**
>
> -   [서버 Repository](https://github.com/leejucheol/DP-disease_prediction)
> -   [서비스 설명 Repository](https://github.com/leejucheol/DP-disease_prediction)

## 2. 프로젝트 배경

질병은 단백질 구조를 통해 알 수 있다. 또한 단백질 구조는 단백질 서열에 의해 정의된다. 따라서 단백질 서열을 통해 관련 질병을 학습하고, 미지의 단백질 서열이 입력되었을 때, 관련 질병을 예측할 수 있지 않을까하는 의문에서 시작하였다.

## 3. ESM모델은 무엇인가?

단백질 서열을 기반으로 질병을 예측하고자 ESM언어 모델을 활용하였습니다. 이는 단순히 문자열로 처리하는 것이 아니라, 단백질 구조적 및 생물학적 특성을 반영하는 벡터로 변환하는데 효과적이기에 선택하였습니다. 단백질 서열의 각각 아미노산에 대해 320차원의 벡터를 생성하고 이는 모델이 서열의 맥락적 의미를 이해하고 예측 모델 입력으로 활용될 수 있도록 돕습니다.

## 4. 네트워크 연결망을 사용하지 않고, 왜 GCN을 사용했나요?

네트워크 연결망 분석은 직접 연결된 이웃 정보에만 의존하고, 복잡한 간접 관계나 다양한 속성 결합이 어렵다는 한계가 있습니다.

GCN은 단백질 서열 임베딩 간의 유사성과 관계성을 그래프로 정의하여, 다중 hop 이웃 정보와 노드 속성을 통합적으로 학습할 수 있어 선택하였습니다.

### 네트워크 연결망 대신 GCN을 활용한 이유

-   **이웃 정보에만 의존하는 한계**: 네트워크 상에서 직접적으로 연결된 이웃의 정보에만 의존하여 예측하기 때문에, **간접적이고 복잡한 관계(2-hop 이상)** 는 잘 반영되지 않습니다.
-   **피처 정보의 결합이 어려움**: 단백질의 서열, 구조, 기능(GO term)과 같은 복잡한 속성 데이터를 네트워크 구조와 함께 통합적으로 학습하기 어렵습니다.
-   **노이즈에 취약하고 일반화가 어려움**: 연결망에서의 한두 개의 잘못된 엣지나 결손된 정보가 전체 예측 성능에 영향을 줄 수 있으며, 데이터가 희소할수록 정확도 저하가 심각합니다.

## 5. 모델 서버 : FastAPI

-   빠른 속도와 비동기 처리가 가능한 백엔드 프레임워크로, 모델 예측 API를 효율적으로 제공하기 때문에 선택하였습니다.

-   `/predict` 엔드 포인터로 단백질 서열을 입력했을 때 관련 질병을 예측하여 사용자에게 상위 5개를 보여줍니다.

## 6. 프로젝트 구조 요약

### 6-1. 사용자 INPUT

본 시스템은 단백질 서열 기반 질병 예측을 목표로 하며, 사용자는 예측하고자 하는 단백질 서열을 입력합니다. 입력 정보는 다음과 같은 형태로 제공됩니다:

항목: `Protein Sequence`  
설명: Protein sequence(예: MKLLAQ..T)

> 시스템은 입력된 단백질 서열은 내부적으로 임베딩 벡터로 변환된어, 학습된 모델을 통해 관련 질병 예측 결과를 도출합니다.

### 6-2. 모델 OUTPUT

모델은 입력된 단백질에 대해, 관련 질병 및 관련 단백질을 예측하고, 예측 결과는 다음과 같은 항목으로 구성됩니다:

-   현재 기능적 정보와 관련 단백질 정보를 함께 제공하기 위한 개발을 진행하고 있습니다.

항목: `disease_id`
설명: 예측된 질병 아이디

항목: `disease_name`  
설명: 해당 단백질과 연관될 가능성이 높은 예측된 질병 이름 리스트

항목: `probability`
설명: 질병이 발생할 확률

> 모델은 위 정보를 바탕으로 질병 예측 결과를 사용자에게 텍스트와 확률을 시각화 하여 제공하고 있습니다.

-   현재는 관련 단백질을 네트워크 시각화 형태로 제공할 수 있도록 개발을 진행하고 있습니다.

## 7. 프로젝트 결과 및 개선 사항

-   딥러닝 모델을 활용하여 단백질 서열의 특징을 학습했고, 입력된 서열과 가장 유사한 패턴을 가진 질병을 예측하는 결과를 도출했습니다.
-   미지 단백질에 관한 예측 시스템의 성능은 교차 검증 기법을 활용하여 성능 검증을 의논중에 있습니다.
-   현재 모델은 단백질의 **1차 구조(서열)**만을 기반으로 질병을 예측한다는 한계가 있었습니다.
-   단백질의 기능과 질병 발생에 영향을 미치는 3차원 구조나 다른 단백질과의 상호작용 같은 복합적인 정보를 반영하여 개선할 생각입니다.
